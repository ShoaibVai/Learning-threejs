{
  "id": "ssh-hardening",
  "title": "SSH Security & Key-Based Authentication",
  "slug": "ssh-hardening",
  "overview": "Harden SSH access with key-based authentication, disable password login, and use fail2ban to prevent brute force attacks.",
  "objectives": ["Generate and use SSH keys", "Disable password authentication", "Configure fail2ban", "Use non-standard SSH ports"],
  "prerequisites": ["SSH access to a server", "Basic Linux command line"],
  "durationMinutes": 55,
  "order": 1,
  "sections": [{"type": "reading", "title": "SSH Security Best Practices", "content": "# Securing SSH\n\n## Why Key-Based Auth?\n\n- Passwords can be brute-forced\n- SSH keys are cryptographically strong (2048-4096 bit)\n- Keys can't be guessed\n\n## Best Practices\n\n1. Use SSH keys, disable passwords\n2. Disable root login\n3. Change default port (22)\n4. Use fail2ban to block attackers\n5. Use two-factor authentication (advanced)\n\n## SSH Key Generation\n\n```bash\nssh-keygen -t ed25519 -C \"your_email@example.com\"\n```\n\nGenerates:\n- Private key: `~/.ssh/id_ed25519` (never share!)\n- Public key: `~/.ssh/id_ed25519.pub` (copy to server)"}],
  "resources": [{"title": "SSH Academy", "url": "https://www.ssh.com/academy/ssh", "type": "article"}, {"title": "fail2ban Documentation", "url": "https://www.fail2ban.org/", "type": "documentation"}],
  "miniProject": {"title": "Harden SSH Access", "description": "Configure key-based SSH, disable password auth, install fail2ban", "estimatedTime": 50, "steps": ["Generate SSH key pair", "Copy public key to server", "Test key-based login", "Disable password authentication in sshd_config", "Disable root login", "Install and configure fail2ban", "Test: failed password attempts get banned"], "deliverables": ["SSH key-based login working", "Password auth disabled", "fail2ban active"], "rubric": ["Keys working (3 pts)", "Passwords disabled (3 pts)", "fail2ban configured (2 pts)", "Root login disabled (2 pts)"], "starterPath": "/practice/server-starters/ssh-hardening"},
  "quiz": {"passingScore": 70, "questions": [{"id": "q1", "type": "single", "question": "Which is more secure?", "options": ["Password authentication", "SSH key authentication", "No authentication", "Certificate authentication"], "correctAnswer": "SSH key authentication", "explanation": "SSH keys use strong cryptography and can't be brute-forced like passwords.", "points": 10}, {"id": "q2", "type": "single", "question": "Which file should NEVER be shared?", "options": ["~/.ssh/id_rsa.pub", "~/.ssh/id_rsa", "~/.ssh/known_hosts", "~/.ssh/config"], "correctAnswer": "~/.ssh/id_rsa", "explanation": "The private key (id_rsa without .pub) must be kept secret. The .pub file is your public key.", "points": 15}, {"id": "q3", "type": "single", "question": "What does fail2ban do?", "options": ["Encrypts SSH traffic", "Generates SSH keys", "Blocks IPs after failed login attempts", "Manages firewall rules"], "correctAnswer": "Blocks IPs after failed login attempts", "explanation": "fail2ban monitors logs and bans IPs with repeated failed logins.", "points": 15}, {"id": "q4", "type": "multiple", "question": "SSH hardening measures?", "options": ["Disable root login", "Change default port", "Use passwords only", "Disable password auth"], "correctAnswer": ["Disable root login", "Change default port", "Disable password auth"], "explanation": "Multiple layers: keys not passwords, no root, non-standard port.", "points": 20}, {"id": "q5", "type": "short-answer", "question": "Why disable password authentication after setting up SSH keys?", "correctAnswer": "To prevent brute force attacks and enforce stronger key-based authentication", "explanation": "Password auth is vulnerable to automated attacks. Key-based auth is much stronger.", "points": 40}]},
  "environment": {"setupSteps": ["Ensure SSH server running: sudo systemctl status sshd", "Backup sshd_config: sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak"], "commands": ["ssh-keygen -t ed25519", "ssh-copy-id user@server", "sudo systemctl restart sshd", "sudo fail2ban-client status", "sudo fail2ban-client status sshd"], "troubleshooting": [{"issue": "Locked out after disabling passwords", "solution": "Always test key-based login works BEFORE disabling passwords. Keep a backup session open."}, {"issue": "Permission denied (publickey)", "solution": "Check ~/.ssh/authorized_keys permissions (600), ensure private key is loaded: ssh-add ~/.ssh/id_ed25519"}]}
}
