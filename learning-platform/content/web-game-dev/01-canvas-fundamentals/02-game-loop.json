{
  "id": "game-loop",
  "title": "The Game Loop Pattern",
  "slug": "game-loop",
  "overview": "Master the game loop - the heart of every game. Learn about requestAnimationFrame, delta time, and separating update from render logic.",
  "objectives": ["Understand the game loop pattern", "Use requestAnimationFrame for smooth animation", "Implement delta time for frame-independent movement", "Separate update and render logic"],
  "prerequisites": ["Canvas basics", "JavaScript functions and callbacks"],
  "durationMinutes": 55,
  "order": 2,
  "sections": [{"type": "reading", "title": "Game Loop Architecture", "content": "# The Game Loop\n\nEvery game runs a continuous loop:\n\n```\nwhile (game is running) {\n    processInput()\n    update(deltaTime)\n    render()\n}\n```\n\n## Why requestAnimationFrame?\n\n**Bad:** `setInterval(gameLoop, 16)` - not synchronized with display\n**Good:** `requestAnimationFrame(gameLoop)` - syncs with monitor refresh (usually 60 FPS)\n\n## Delta Time\n\nFrame rate varies! Use delta time for consistent movement:\n\n```javascript\nlet lastTime = 0;\n\nfunction gameLoop(timestamp) {\n    const deltaTime = (timestamp - lastTime) / 1000; // seconds\n    lastTime = timestamp;\n    \n    // Frame-independent movement\n    player.x += player.speedX * deltaTime;\n    \n    requestAnimationFrame(gameLoop);\n}\n\nrequestAnimationFrame(gameLoop);\n```\n\n**Without delta time:** Movement speed depends on FPS\n**With delta time:** Consistent speed regardless of FPS"}],
  "resources": [{"title": "Fix Your Timestep", "url": "https://gafferongames.com/post/fix_your_timestep/", "type": "article"}, {"title": "Game Loop Patterns", "url": "https://gameprogrammingpatterns.com/game-loop.html", "type": "article"}],
  "miniProject": {"title": "Animated Bouncing Ball", "description": "Create a ball that bounces around the canvas with smooth animation", "estimatedTime": 50, "steps": ["Set up canvas and game loop", "Create ball object with position and velocity", "Update ball position using delta time", "Detect canvas edge collisions", "Reverse velocity on collision (bounce)", "Display FPS counter"], "deliverables": ["Smoothly animating ball", "Proper edge detection", "Frame-independent movement", "FPS display"], "rubric": ["Game loop implemented (3 pts)", "Delta time used (3 pts)", "Collision works (2 pts)", "Smooth animation (2 pts)"], "starterPath": "/practice/game-starters/canvas-vite-ts"},
  "quiz": {"passingScore": 70, "questions": [{"id": "q1", "type": "single", "question": "Which is best for game loops?", "options": ["setInterval", "setTimeout", "requestAnimationFrame", "while loop"], "correctAnswer": "requestAnimationFrame", "explanation": "requestAnimationFrame syncs with display refresh for smooth animation.", "points": 15}, {"id": "q2", "type": "single", "question": "What is delta time?", "options": ["Total game time", "Time between frames", "Frame rate", "Animation speed"], "correctAnswer": "Time between frames", "explanation": "Delta time is the time elapsed since the last frame, ensuring consistent movement.", "points": 15}, {"id": "q3", "type": "single", "question": "Typical refresh rate?", "options": ["30 FPS", "60 FPS", "120 FPS", "144 FPS"], "correctAnswer": "60 FPS", "explanation": "Most displays run at 60 Hz (60 FPS). Gaming monitors may be higher.", "points": 10}, {"id": "q4", "type": "multiple", "question": "Game loop phases?", "options": ["Input processing", "Update logic", "Rendering", "Compilation"], "correctAnswer": ["Input processing", "Update logic", "Rendering"], "explanation": "Classic game loop: input → update → render. Compilation happens before runtime.", "points": 20}, {"id": "q5", "type": "short-answer", "question": "Why use delta time for movement?", "correctAnswer": "To ensure consistent movement speed regardless of frame rate variations, making gameplay identical on different hardware", "explanation": "Delta time makes game logic frame-rate independent.", "points": 40}]},
  "environment": {"setupSteps": ["Use canvas starter from previous lesson", "No special tools needed", "Browser DevTools for performance monitoring"], "commands": ["# Performance monitoring\nOpen DevTools > Performance tab\nRecord while game runs"], "troubleshooting": [{"issue": "Animation stutters", "solution": "Ensure using requestAnimationFrame, not setInterval. Check for expensive operations in update/render."}, {"issue": "Movement too fast/slow", "solution": "Check delta time calculation. Ensure multiplying speed by deltaTime. Verify deltaTime is in seconds, not milliseconds."}]}
}
