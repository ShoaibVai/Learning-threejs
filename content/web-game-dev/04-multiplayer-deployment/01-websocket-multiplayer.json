{
  "id": "websocket-multiplayer",
  "title": "Real-time Multiplayer with WebSockets",
  "slug": "websocket-multiplayer",
  "overview": "Build real-time multiplayer games using WebSockets for bidirectional communication, handle network latency, and implement basic client-server architecture.",
  "objectives": ["Understand WebSocket protocol", "Implement client-server communication", "Handle latency and prediction", "Create multiplayer room system"],
  "prerequisites": ["Node.js basics", "Async JavaScript", "Game development fundamentals"],
  "durationMinutes": 80,
  "order": 1,
  "sections": [{"type": "reading", "title": "WebSocket Multiplayer", "content": "# Real-time Multiplayer\n\n## WebSocket Protocol\n\nUpgrade from HTTP to persistent connection:\n\n```javascript\n// Server (Node.js + ws library)\nconst WebSocket = require('ws');\nconst wss = new WebSocket.Server({ port: 8080 });\n\nconst clients = new Set();\n\nwss.on('connection', (ws) => {\n    clients.add(ws);\n    \n    ws.on('message', (data) => {\n        const msg = JSON.parse(data);\n        \n        // Broadcast to all clients\n        for (let client of clients) {\n            if (client !== ws && client.readyState === WebSocket.OPEN) {\n                client.send(JSON.stringify(msg));\n            }\n        }\n    });\n    \n    ws.on('close', () => {\n        clients.delete(ws);\n    });\n});\n```\n\n```javascript\n// Client\nconst ws = new WebSocket('ws://localhost:8080');\n\nws.onopen = () => {\n    console.log('Connected!');\n    ws.send(JSON.stringify({ type: 'join', name: 'Player1' }));\n};\n\nws.onmessage = (event) => {\n    const msg = JSON.parse(event.data);\n    handleServerMessage(msg);\n};\n```\n\n## Network Challenges\n\n1. **Latency**: Messages take time\n2. **Packet loss**: Messages may not arrive\n3. **Order**: Messages may arrive out of order\n\n## Client Prediction\n\nMove immediately on client, reconcile with server:\n\n```javascript\n// Client: Predict movement\nplayer.x += input.x * speed;\n\n// Server: Authoritative position\nsendToClient({ type: 'update', x: serverX, y: serverY });\n\n// Client: Reconcile\nif (Math.abs(serverX - player.x) > threshold) {\n    player.x = serverX; // Snap to server\n}\n```"}],
  "resources": [{"title": "WebSocket API MDN", "url": "https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API", "type": "documentation"}, {"title": "Multiplayer Game Programming", "url": "https://www.gabrielgambetta.com/client-server-game-architecture.html", "type": "article"}, {"title": "Fast-Paced Multiplayer", "url": "https://www.gabrielgambetta.com/client-side-prediction-server-reconciliation.html", "type": "article"}],
  "miniProject": {"title": "Multiplayer Room System", "description": "Create a simple multiplayer game where players see each other move in real-time", "estimatedTime": 100, "steps": ["Set up WebSocket server (Node.js)", "Implement room/lobby system", "Broadcast player positions", "Add client prediction for local player", "Interpolate remote players", "Add basic chat system", "Handle disconnections gracefully", "Test with multiple browser tabs"], "deliverables": ["Working WebSocket server", "Multiple players visible", "Smooth movement with prediction"], "rubric": ["Server/client communication (3 pts)", "Multiple players working (3 pts)", "Prediction/interpolation (2 pts)", "Clean code (2 pts)"], "starterPath": "/practice/game-starters/websocket-multiplayer-basic"},
  "quiz": {"passingScore": 70, "questions": [{"id": "q1", "type": "single", "question": "What is WebSocket?", "options": ["HTTP replacement", "Persistent bidirectional connection", "File transfer protocol", "Database connector"], "correctAnswer": "Persistent bidirectional connection", "explanation": "WebSocket provides full-duplex communication over a single TCP connection.", "points": 15}, {"id": "q2", "type": "single", "question": "Why use client prediction?", "options": ["To cheat", "To reduce perceived latency", "To save bandwidth", "To improve graphics"], "correctAnswer": "To reduce perceived latency", "explanation": "Client prediction makes controls feel responsive despite network delay.", "points": 15}, {"id": "q3", "type": "single", "question": "Who should be authoritative in multiplayer?", "options": ["Client", "Server", "Whoever is faster", "Both equally"], "correctAnswer": "Server", "explanation": "Server is authoritative to prevent cheating. Client predictions are validated by server.", "points": 15}, {"id": "q4", "type": "multiple", "question": "Multiplayer challenges?", "options": ["Network latency", "Packet loss", "Cheaters", "Better graphics"], "correctAnswer": ["Network latency", "Packet loss", "Cheaters"], "explanation": "Multiplayer must handle latency, unreliable networks, and malicious clients.", "points": 20}, {"id": "q5", "type": "short-answer", "question": "Explain the difference between client prediction and server reconciliation", "correctAnswer": "Client prediction applies input immediately for responsiveness, while server reconciliation corrects client state when server's authoritative update arrives, ensuring consistency", "explanation": "This pattern balances responsive controls with server authority.", "points": 35}]},
  "environment": {"setupSteps": ["Install Node.js and npm", "npm install ws (WebSocket library)", "Create separate server.js and client HTML"], "commands": ["node server.js  # Start WebSocket server", "# Client connects to ws://localhost:8080"], "troubleshooting": [{"issue": "Connection refused", "solution": "Ensure server is running. Check port not in use. Verify ws:// URL (not wss:// without SSL)."}, {"issue": "Players jittery/teleporting", "solution": "Implement interpolation for remote players. Use lerp: pos += (target - pos) * 0.1"}]}
}
